<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Salvemos MithosMC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background: #0f172a;
      }
      .progress-bar-animation {
        transition: width 1s ease-in-out;
      }
      .glass-effect {
        background: rgba(30, 41, 59, 0.7);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .glow {
        text-shadow: 0 0 20px rgba(129, 140, 248, 0.5);
      }
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.3s ease;
      }
      .modal.active {
        display: flex;
        opacity: 1;
      }
      .modal-content {
        transform: scale(0.95);
        transition: transform 0.3s ease;
      }
      .modal.active .modal-content {
        transform: scale(1);
      }
    </style>
  </head>
  <body class="bg-slate-900 text-gray-100">
    <header class="glass-effect sticky top-0 z-50 shadow-lg shadow-indigo-500/10">
      <nav class="container mx-auto px-6 py-5">
        <div class="flex justify-between items-center">
          <a href="#" class="text-2xl font-bold text-white flex items-center gap-2">
            <span class="text-indigo-400">Mithos</span>MC
          </a>
          <button
            id="donateBtn"
            class="bg-indigo-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition duration-300 shadow-lg shadow-indigo-600/20"
          >
            Donar
          </button>
        </div>
      </nav>
    </header>

    <main class="container mx-auto px-4 py-12">
      <section class="text-center mb-20">
        <h1 class="text-7xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 glow tracking-tight">
          Salvemos MithosMC
        </h1>
        <p class="text-2xl text-gray-400 max-w-3xl mx-auto leading-relaxed">
          Juntos reconstruiremos nuestra comunidad. Cada contribución cuenta.
        </p>
      </section>

      <section id="progress" class="mb-20">
        <div class="glass-effect rounded-2xl shadow-xl p-12">
          <h2 class="text-4xl font-bold mb-10 text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 text-center">
            Progreso de la Recaudación
          </h2>
          <div class="mb-8">
            <div class="w-full bg-slate-800 rounded-full h-14 overflow-hidden shadow-inner">
              <div
                id="progress-bar"
                class="progress-bar-animation bg-gradient-to-r from-indigo-600 via-indigo-500 to-purple-500 h-full rounded-full flex items-center justify-center"
                style="width: 0%"
              >
                <span
                  id="progress-text"
                  class="text-lg font-bold text-white drop-shadow-md px-4"
                ></span>
              </div>
            </div>
          </div>
          <div class="text-center space-y-3">
            <p id="progress-amount" class="text-4xl font-bold text-white"></p>
            <p id="remaining-amount" class="text-xl text-gray-400"></p>
          </div>
        </div>
      </section>

      <section id="payment-history" class="mb-20">
        <div class="glass-effect rounded-2xl shadow-xl p-12">
          <h2 class="text-4xl font-bold mb-10 text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 text-center">
            Donantes Recientes
          </h2>
          <div class="overflow-x-auto">
            <table class="min-w-full">
              <thead class="border-b border-slate-700">
                <tr>
                  <th class="py-4 px-6 text-left text-lg font-semibold text-indigo-400">Donante</th>
                  <th class="py-4 px-6 text-left text-lg font-semibold text-indigo-400">Cantidad</th>
                </tr>
              </thead>
              <tbody id="payment-table-body"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section class="mb-20">
        <div class="glass-effect rounded-2xl shadow-xl p-12">
          <h2 class="text-4xl font-bold mb-10 text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 text-center">
            Nuestra Misión
          </h2>
          <p class="text-xl text-gray-300 leading-relaxed mb-8">
            MithosMC ha enfrentado un desafío sin precedentes, pero juntos lo
            superaremos. Nuestro objetivo es recaudar fondos para:
          </p>
          <ul class="list-none space-y-6 mb-8">
            <li class="flex items-center text-lg text-gray-300">
              <svg class="w-6 h-6 text-indigo-400 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Adquirir un nuevo host con mayor seguridad
            </li>
            <li class="flex items-center text-lg text-gray-300">
              <svg class="w-6 h-6 text-indigo-400 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Implementar sistemas de seguridad avanzados
            </li>
            <li class="flex items-center text-lg text-gray-300">
              <svg class="w-6 h-6 text-indigo-400 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Reconstruir y mejorar el mundo de MithosMC
            </li>
          </ul>
          <p class="text-xl text-gray-300 leading-relaxed">
            Con tu ayuda, crearemos un MithosMC más fuerte y emocionante que
            nunca.
          </p>
        </div>
      </section>
    </main>

    <footer class="glass-effect py-8">
      <div class="container mx-auto px-4 text-center text-gray-400">
        <p>&copy; 2024 MithosMC. Todos los derechos reservados.</p>
      </div>
    </footer>

    <!-- Modal de Donación -->
    <div id="donateModal" class="modal items-center justify-center">
      <div class="modal-content glass-effect p-8 rounded-2xl max-w-md mx-4 w-full">
        <h3 class="text-2xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400">Información de Donación</h3>
        <p class="text-gray-300 mb-6">Para realizar una donación, por favor contacta a través de Discord:</p>
        <div class="bg-slate-800 p-4 rounded-lg mb-6 flex items-center justify-between">
          <span class="text-indigo-400 font-semibold">glazzier_</span>
          <button id="copyDiscord" class="text-sm bg-indigo-600 px-4 py-2 rounded hover:bg-indigo-700 transition-colors">
            Copiar
          </button>
        </div>
        <button id="closeModal" class="w-full bg-slate-700 text-white py-3 rounded-lg hover:bg-slate-600 transition-colors">
          Cerrar
        </button>
      </div>
    </div>

    <script>
      const goalAmount = 400;
      let paymentData = null;

      async function fetchPaymentData() {
        try {
          const response = await fetch("payments.json");
          if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
          const data = await response.json();
          const payments = Array.isArray(data.payments) ? data.payments : [];
          
          paymentData = {
            payments: payments,
            totalAmount: payments.reduce(
              (total, payment) => total + (Number(payment.amount) || 0),
              0
            ),
          };
          
          updateProgressBar();
          populatePaymentHistory();
        } catch (error) {
          console.error("Error:", error);
          paymentData = { payments: [], totalAmount: 0 };
          updateProgressBar();
        }
      }

      function updateProgressBar() {
        const progressBar = document.getElementById("progress-bar");
        const progressText = document.getElementById("progress-text");
        const progressAmount = document.getElementById("progress-amount");
        const remainingAmount = document.getElementById("remaining-amount");
        
        const totalAmount = Number(paymentData.totalAmount) || 0;
        const percentage = Math.min((totalAmount / goalAmount) * 100, 100);
        const remaining = Math.max(goalAmount - totalAmount, 0);

        progressBar.style.width = `${Math.max(percentage, 1)}%`; // Mínimo 1% para siempre mostrar algo
        progressText.textContent = `${percentage.toFixed(1)}%`;
        progressAmount.textContent = `${totalAmount.toFixed(2)}€ recaudados`;
        remainingAmount.textContent = `Faltan ${remaining.toFixed(2)}€ para alcanzar el objetivo`;
      }

      function populatePaymentHistory() {
        const tableBody = document.getElementById("payment-table-body");
        tableBody.innerHTML = "";

        if (!paymentData.payments?.length) {
          tableBody.innerHTML = `
            <tr>
              <td colspan="2" class="py-6 px-6 text-center text-gray-500 italic">
                No hay donaciones registradas aún
              </td>
            </tr>`;
          return;
        }

        paymentData.payments.slice(0, 5).forEach((payment, index) => {
          const row = document.createElement("tr");
          row.className = index % 2 === 0 ? "bg-slate-800/30" : "bg-transparent";
          row.innerHTML = `
            <td class="py-4 px-6">
              <div class="font-semibold text-gray-300">${payment.username || 'Anónimo'}</div>
            </td>
            <td class="py-4 px-6 text-indigo-400 font-semibold">${Number(payment.amount).toFixed(2)}€</td>
          `;
          tableBody.appendChild(row);
        });
      }

      fetchPaymentData();

      // Modal functionality
      const modal = document.getElementById('donateModal');
      const donateBtn = document.getElementById('donateBtn');
      const closeModal = document.getElementById('closeModal');
      const copyDiscord = document.getElementById('copyDiscord');

      donateBtn.addEventListener('click', () => {
        modal.classList.add('active');
      });

      closeModal.addEventListener('click', () => {
        modal.classList.remove('active');
      });

      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.remove('active');
        }
      });

      copyDiscord.addEventListener('click', () => {
        navigator.clipboard.writeText('glazzier_').then(() => {
          const originalText = copyDiscord.textContent;
          copyDiscord.textContent = '¡Copiado!';
          copyDiscord.classList.add('bg-green-600');
          
          setTimeout(() => {
            copyDiscord.textContent = originalText;
            copyDiscord.classList.remove('bg-green-600');
          }, 2000);
        });
      });
    </script>
  </body>
</html>
